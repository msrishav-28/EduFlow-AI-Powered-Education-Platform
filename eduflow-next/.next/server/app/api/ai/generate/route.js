"use strict";(()=>{var e={};e.id=505,e.ids=[505],e.modules={20399:e=>{e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},30517:e=>{e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},58423:(e,t,n)=>{n.r(t),n.d(t,{originalPathname:()=>h,patchFetch:()=>y,requestAsyncStorage:()=>m,routeModule:()=>f,serverHooks:()=>w,staticGenerationAsyncStorage:()=>g});var r={};n.r(r),n.d(r,{POST:()=>d});var a=n(49303),o=n(88716),s=n(60670),i=n(87070);async function p(e){let t=process.env.GOOGLE_GENAI_API_KEY;if(!t)throw Error("GOOGLE_GENAI_API_KEY not configured");let{GoogleGenerativeAI:r}=await n.e(258).then(n.bind(n,11258)),a=new r(t).getGenerativeModel({model:"gemini-2.0-flash-exp"}),o=await a.generateContent(e);return(await o.response).text()}async function u(e){let t=process.env.OLLAMA_BASE_URL||"http://localhost:11434",n=process.env.OLLAMA_MODEL||"gemma2:27b",r=await fetch(`${t}/api/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:n,prompt:e,stream:!1})});if(!r.ok)throw Error(`Ollama error ${r.status}`);return(await r.json()).response}async function l(e){let t=process.env.OLLAMA_BASE_URL||"http://localhost:11434",n=process.env.OLLAMA_MODEL||"gemma2:27b",r=await fetch(`${t}/api/generate`,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({model:n,prompt:e,stream:!0})});if(!r.ok||!r.body)throw Error(`Ollama stream error ${r.status}`);return r.body}async function c(e){let t=process.env.GOOGLE_GENAI_API_KEY;if(!t)throw Error("GOOGLE_GENAI_API_KEY not configured");let{GoogleGenerativeAI:r}=await n.e(258).then(n.bind(n,11258)),a=new r(t).getGenerativeModel({model:"gemini-2.0-flash-exp"}),o=await a.generateContentStream(e);return new ReadableStream({async start(e){try{for await(let t of o.stream){let n="function"==typeof t?.text?t.text():t?.candidates?.[0]?.content?.parts?.[0]?.text??"";n&&e.enqueue(new TextEncoder().encode(JSON.stringify({response:n})+"\n"))}e.close()}catch(t){e.error(t)}}})}async function d(e){try{let{prompt:t,provider:n,stream:r}=await e.json();if(!t||"string"!=typeof t)return i.NextResponse.json({error:"Missing prompt"},{status:400});let a="",o=n||"auto";if("gemini"===o){if(r){let e=await c(t);return new Response(e,{headers:{"Content-Type":"text/event-stream"}})}a=await p(t)}else if("ollama"===o){if(r){let e=await l(t);return new Response(e,{headers:{"Content-Type":"text/event-stream"}})}a=await u(t)}else try{if(r){let e=await c(t);return new Response(e,{headers:{"Content-Type":"text/event-stream"}})}a=await p(t)}catch{try{if(r){let e=await l(t);return new Response(e,{headers:{"Content-Type":"text/event-stream"}})}a=await u(t)}catch{a=function(e){let t=[["explain","Here is an explanation based on offline knowledge..."],["summarize","Summary generated using offline model..."],["quiz","Here are some practice questions: 1) ... 2) ..."],["code","Here is some guidance for your code..."]].find(([t])=>e.toLowerCase().includes(t))?.[1]||"Using offline fallback to assist you.";return`${t} (offline)`}(t)}}return i.NextResponse.json({content:a})}catch(e){return i.NextResponse.json({error:e?.message||"AI generate failed"},{status:500})}}let f=new a.AppRouteRouteModule({definition:{kind:o.x.APP_ROUTE,page:"/api/ai/generate/route",pathname:"/api/ai/generate",filename:"route",bundlePath:"app/api/ai/generate/route"},resolvedPagePath:"C:\\Users\\Lenovo\\Downloads\\INTERNSHIP\\INTERNSHIP\\project\\eduflow-next\\app\\api\\ai\\generate\\route.ts",nextConfigOutput:"",userland:r}),{requestAsyncStorage:m,staticGenerationAsyncStorage:g,serverHooks:w}=f,h="/api/ai/generate/route";function y(){return(0,s.patchFetch)({serverHooks:w,staticGenerationAsyncStorage:g})}}};var t=require("../../../../webpack-runtime.js");t.C(e);var n=e=>t(t.s=e),r=t.X(0,[948,972],()=>n(58423));module.exports=r})();